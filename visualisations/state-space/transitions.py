# import
import networkx as nx
import matplotlib.pyplot as plt
from pyvis.network import Network
import math
from tarjan_algo import *

G = nx.MultiDiGraph()

edges = [ ('10135', '9623'), ('10143', '10135'), ('10143', '9623'), ('10143', '9631'), ('10231', '10135'), ('10239', '10135'), ('10239', '10143'), ('10239', '2047'), ('10239', '9631'), ('10239', '9727'), ('115971', '115975'), ('115971', '115979'), ('115971', '116099'), ('115971', '83203'), ('115971', '83207'), ('115971', '83211'), ('115971', '83215'), ('115971', '83331'), ('115975', '115971'), ('115975', '115983'), ('115975', '116103'), ('115975', '124167'), ('115975', '83207'), ('115975', '83215'), ('115979', '115971'), ('115979', '83211'), ('115983', '115975'), ('115983', '115979'), ('115983', '83215'), ('116099', '115971'), ('116099', '50563'), ('116099', '83331'), ('116099', '83335'), ('116099', '99715'), ('116103', '115971'), ('116103', '115975'), ('116103', '116099'), ('116103', '124295'), ('116103', '50567'), ('116103', '83335'), ('116103', '91527'), ('124167', '115975'), ('124167', '124295'), ('124295', '116103'), ('124295', '124167'), ('124295', '58759'), ('124295', '91527'), ('1415', '17799'), ('1415', '34183'), ('1415', '66947'), ('1415', '66951'), ('1415', '83335'), ('1415', '9607'), ('1431', '1415'), ('1431', '1439'), ('1431', '9623'), ('1439', '1431'), ('1439', '1535'), ('1439', '66975'), ('1439', '9631'), ('1527', '1415'), ('1527', '1431'), ('1535', '1431'), ('1535', '1439'), ('1535', '2047'), ('1535', '66975'), ('1535', '67071'), ('1535', '9631'), ('1535', '9727'), ('17795', '83431'), ('17799', '1415'), ('17799', '25991'), ('17799', '50567'), ('1943', '1431'), ('1943', '9623'), ('2039', '10135'), ('2039', '10231'), ('2039', '1431'), ('2039', '1527'), ('2039', '1943'), ('2039', '67583'), ('2039', '9623'), ('2047', '10135'), ('2047', '10143'), ('2047', '10239'), ('2047', '1527'), ('2047', '1535'), ('2047', '2039'), ('2047', '67071'), ('2047', '67583'), ('2047', '9631'), ('2047', '9727'), ('25583', '26607'), ('25991', '124295'), ('25991', '1415'), ('25991', '17799'), ('25991', '25999'), ('25991', '58759'), ('25991', '91527'), ('25991', '91535'), ('25991', '9607'), ('25999', '25991'), ('25999', '26095'), ('25999', '91535'), ('26087', '25991'), ('26095', '25999'), ('26095', '26087'), ('26095', '26607'), ('26095', '91631'), ('26599', '25991'), ('26599', '26087'), ('26607', '26095'), ('26607', '26599'), ('26607', '91631'), ('26607', '92143'), ('34179', '116099'), ('34179', '34183'), ('34179', '50563'), ('34179', '99715'), ('34179', '99719'), ('34183', '116099'), ('34183', '116103'), ('34183', '1415'), ('34183', '34179'), ('34183', '66951'), ('34183', '83335'), ('34183', '99715'), ('34183', '99719'), ('50563', '116099'), ('50563', '17795'), ('50567', '116103'), ('50567', '124295'), ('50567', '17799'), ('50567', '58759'), ('58759', '124295'), ('58759', '25991'), ('58759', '50567'), ('66823', '115975'), ('66823', '66831'), ('66823', '83207'), ('66823', '83215'), ('66823', '99591'), ('66831', '66847'), ('66831', '66975'), ('66831', '83215'), ('66831', '83231'), ('66847', '66831'), ('66847', '66943'), ('66847', '83231'), ('66847', '83327'), ('66943', '83327'), ('66947', '83331'), ('66951', '115975'), ('66951', '116103'), ('66951', '1415'), ('66951', '66823'), ('66951', '66831'), ('66951', '66959'), ('66951', '66967'), ('66951', '66975'), ('66951', '67047'), ('66951', '83335'), ('66951', '83431'), ('66951', '99719'), ('66959', '66831'), ('66959', '66847'), ('66959', '66975'), ('66967', '1415'), ('66967', '1431'), ('66967', '66951'), ('66967', '66975'), ('66967', '67063'), ('66967', '67071'), ('66967', '83447'), ('66975', '66847'), ('66975', '66951'), ('66975', '66967'), ('66975', '67071'), ('66975', '75167'), ('66975', '83231'), ('66975', '83359'), ('66975', '83455'), ('67047', '1415'), ('67047', '67063'), ('67063', '1527'), ('67063', '66951'), ('67063', '67047'), ('67063', '67071'), ('67063', '67575'), ('67063', '83447'), ('67071', '1535'), ('67071', '66943'), ('67071', '66967'), ('67071', '66975'), ('67071', '67063'), ('67071', '67583'), ('67071', '83327'), ('67071', '83359'), ('67071', '83455'), ('67575', '2039'), ('67575', '67583'), ('67583', '2047'), ('67583', '67071'), ('67583', '83967'), ('75159', '66967'), ('75159', '75167'), ('75167', '66967'), ('75167', '66975'), ('75167', '67071'), ('75167', '75159'), ('75263', '67071'), ('83203', '115971'), ('83203', '116099'), ('83203', '83207'), ('83203', '83211'), ('83203', '83215'), ('83203', '83331'), ('83207', '115971'), ('83207', '115975'), ('83207', '115983'), ('83207', '83203'), ('83207', '83215'), ('83207', '83335'), ('83207', '83343'), ('83211', '115971'), ('83211', '115979'), ('83211', '83203'), ('83211', '83215'), ('83215', '115971'), ('83215', '115975'), ('83215', '115979'), ('83215', '115983'), ('83215', '83203'), ('83215', '83207'), ('83215', '83211'), ('83215', '83231'), ('83215', '83311'), ('83215', '83327'), ('83231', '115983'), ('83231', '83215'), ('83231', '83327'), ('83311', '83203'), ('83311', '83207'), ('83311', '83211'), ('83311', '83215'), ('83327', '83211'), ('83327', '83215'), ('83327', '83231'), ('83327', '83311'), ('83327', '83331'), ('83327', '83455'), ('83331', '116099'), ('83331', '83335'), ('83331', '83431'), ('83331', '83447'), ('83335', '83207'), ('83335', '83331'), ('83335', '83343'), ('83335', '83351'), ('83335', '83431'), ('83335', '83447'), ('83335', '83455'), ('83335', '91527'), ('83343', '83207'), ('83343', '83335'), ('83343', '83359'), ('83351', '83447'), ('83359', '83335'), ('83359', '83343'), ('83359', '83455'), ('83431', '83331'), ('83431', '83335'), ('83431', '83439'), ('83431', '83447'), ('83431', '83455'), ('83439', '83431'), ('83447', '83331'), ('83447', '83335'), ('83447', '83431'), ('83447', '83455'), ('83455', '67071'), ('83455', '67583'), ('83455', '83231'), ('83455', '83327'), ('83455', '83335'), ('83455', '83343'), ('83455', '83431'), ('83455', '83447'), ('83455', '83967'), ('83967', '67583'), ('83967', '83455'), ('90351', '90863'), ('90351', '91375'), ('90863', '91119'), ('91119', '25583'), ('91119', '90863'), ('91119', '92143'), ('91375', '90351'), ('91375', '91631'), ('91527', '124295'), ('91527', '25991'), ('91527', '83335'), ('91527', '91535'), ('91527', '91623'), ('91527', '91631'), ('91535', '25999'), ('91535', '91527'), ('91535', '91631'), ('91623', '91375'), ('91623', '91631'), ('91631', '26087'), ('91631', '26095'), ('91631', '26607'), ('91631', '91375'), ('91631', '91535'), ('91631', '92143'), ('92143', '26607'), ('92143', '91119'), ('92143', '91631'), ('9607', '1415'), ('9607', '25991'), ('9623', '1415'), ('9623', '1431'), ('9623', '9607'), ('9623', '9631'), ('9631', '1439'), ('9631', '75167'), ('9631', '75263'), ('9631', '9623'), ('9631', '9727'), ('9727', '1439'), ('9727', '1535'), ('9727', '66975'), ('9727', '67071'), ('9727', '9631'), ('99591', '115975'), ('99591', '66823'), ('99591', '83207'), ('99591', '99719'), ('99715', '116099'), ('99715', '34179'), ('99715', '99719'), ('99719', '115975'), ('99719', '116099'), ('99719', '116103'), ('99719', '34183'), ('99719', '66823'), ('99719', '66951'), ('99719', '83335'), ('99719', '99591'), ('99719', '99715'), ]
edge_widths = [ 0.893147, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.2, 3.33549, 0.2, 0.2, 0.2, 0.2, 0.2, 3.6012, 0.2, 0.2, 0.2, 1.29861, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 2.90805, 0.2, 4.20733, 0.2, 0.893147, 0.2, 2.14591, 1.29861, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 2.83906, 3.37805, 0.2, 1.58629, 0.2, 0.2, 1.58629, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 1.29861, 0.2, 0.893147, 0.2, 0.893147, 0.893147, 2.83906, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 1.29861, 0.2, 2.14591, 0.893147, 0.2, 2.68491, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 1.29861, 1.58629, 0.2, 0.2, 0.893147, 0.2, 1.58629, 0.2, 1.29861, 0.2, 1.29861, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 3.88888, 0.2, 0.2, 2.5979, 0.2, 0.2, 0.2, 1.29861, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 0.2, 1.29861, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.893147, 1.80944, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 2.27944, 0.2, 0.2, 2.27944, 0.2, 0.2, 4.46268, 1.99176, 0.893147, 0.2, 0.2, 0.2, 1.80944, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 1.58629, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 0.893147, 1.99176, 0.2, 0.2, 0.2, 1.58629, 1.99176, 0.2, 0.2, 0.2, 0.2, 0.2, 1.29861, 1.58629, 0.2, 0.2, 0.893147, 2.68491, 1.29861, 3.14444, 4.13183, 0.2, 0.2, 0.2, 0.2, 0.2, 1.80944, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 0.2, 3.19573, 0.2, 0.2, 0.2, 0.2, 0.893147, 4.50407, 1.29861, 1.29861, 0.2, 2.27944, 0.2, 0.2, 0.2, 0.2, 4.43411, 4.31087, 2.14591, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.893147, 0.2, 1.29861, 0.2, 0.2, 0.893147, 0.2, 2.14591, 0.2, 0.2, 0.2, 1.58629, 0.2, 0.2, 0.893147, 1.80944, 1.80944, 0.2, 0.2, 2.27944, 0.2, 0.893147, 0.893147, 1.99176, 0.2, 0.2, 1.80944, 0.2, 1.58629, 0.2, 0.2, 0.2, 0.2, 0.2, 1.29861, 3.66574, 0.893147, 0.2, 0.2, 1.99176, 0.2, 0.2, 0.2, 0.893147, 1.29861, 1.29861, 0.2, 0.2, 0.2, 3.72636, 1.58629, ]
nodes = [ '1415', '1431', '1439', '1527', '1535', '1943', '2039', '2047', '9607', '9623', '9631', '9727', '10135', '10143', '10231', '10239', '17795', '17799', '25583', '25991', '25999', '26087', '26095', '26599', '26607', '34179', '34183', '50563', '50567', '58759', '66823', '66831', '66847', '66943', '66947', '66951', '66959', '66967', '66975', '67047', '67063', '67071', '67575', '67583', '75159', '75167', '75263', '83203', '83207', '83211', '83215', '83231', '83311', '83327', '83331', '83335', '83343', '83351', '83359', '83431', '83439', '83447', '83455', '83967', '90351', '90863', '91119', '91375', '91527', '91535', '91623', '91631', '92143', '99591', '99715', '99719', '115971', '115975', '115979', '115983', '116099', '116103', '124167', '124295', ]
node_sizes = [ 259.5, 2.7, 0.6, 0.4, 5, 0.1, 2.3, 467.2, 12.5, 10.4, 7.2, 1.1, 0.5, 0.3, 0.1, 1, 0.1, 122.6, 0.1, 112.7, 19.2, 0.2, 6.3, 0.1, 47.1, 1.1, 143, 0.3, 58.2, 8.3, 2.7, 0.6, 0.9, 0.7, 0.1, 11.2, 0.4, 1, 13.9, 0.1, 0.4, 36.8, 0.1, 237.7, 0.2, 4.3, 0.1, 1.1, 2.6, 1, 12.3, 11.9, 0.2, 63, 68.3, 3.1, 0.1, 0.1, 0.2, 5.2, 0.1, 80.1, 385.5, 46, 1, 0.8, 0.6, 0.3, 10.7, 27.3, 0.3, 51.1, 6.4, 119.3, 4.9, 171.3, 391.9, 92.5, 0.8, 0.9, 190.8, 39.5, 0.2, 10, ]


print(len(edges))


prune_nodes(nodes, node_sizes, edges, edge_widths)
prune_edges(edges, edge_widths)




G.add_nodes_from(nodes)

for i in range(len(edges)):
    G.add_edge(edges[i][0], edges[i][1], width = edge_widths[i])


node_d = {}
for i in range(len(nodes)):
    val = math.sqrt(node_sizes[i])
    val = val * 2
    node_d[nodes[i]] = val

nx.set_node_attributes(G, node_d, 'size')

net = Network(directed=True)
net.repulsion()
net.from_nx(G)
net.show('transitions.html')


CellStates(nodes, edges, node_sizes)



# pos = nx.nx_agraph.graphviz_layout(G)
# nx.draw_networkx_nodes(G, pos, node_size = node_sizes)
# nx.draw_networkx_edges(G, pos, edgelist=G.edges(), nodelist=node_sizes) #, width=edge_widths, connectionstyle='arc3, rad = 0.1') #, nodelist=node_sizes)
# nx.draw_networkx_labels(G,pos)
# plt.show()


